Under one estimate, companies in the S&P 500 index could be forced to take tax-related earnings charges of $235 billion -- about 1% of their combined market value.

The charge will swing Goldman to a quarterly loss and wipe out much of its full-year profit. But the firm, like its brethren on Wall Street and across much of corporate America, will be a winner in the long run as it enjoys the lowest U.S. corporate tax rate in eight decades and gets new flexibility in how it funds itself, invests in the business and returns capital to shareholders.

"They will make this back and then some," said Devin Ryan, an analyst at JMP Securities. "Tax reform is a positive for Goldman Sachs."

Goldman shares fell less than 1%. Analysts had expected the firm to take a tax-related earnings hit of between $3 billion and $6 billion.

About two-thirds of the impact, or $3 billion, is related to a newly enacted, one-time tax on U.S. companies' overseas earnings.

Goldman had $31 billion parked offshore at the end of 2016, much of it in cash that will now be subject to a one-time tax of 15%.

Zion Research Group estimates that S&P 500 companies will book quarterly hits of $235 billion in the coming weeks on the $2.8 trillion they have amassed in foreign operations.

Drugmakers and technology firms, whose mazes of global intellectual-property arrangements rely heavily on subsidiaries in low-tax countries, account for 69% of the total.

Just five companies -- Apple Inc., Microsoft Corp., Pfizer Inc., Oracle Corp. and Cisco Systems Inc. -- account for one-third, according to Zion's estimates.

Most large tech companies will take "a big hit" to their coming earnings, said Edward Kleinbard, a tax professor at the University of Southern California law school.

One exception, he said, is Apple, which has already recorded tax charges for a large portion of its overseas earnings.

Drugmaker Amgen Inc., which has nearly $40 billion parked abroad, said last week that it expects to incur a tax expense of at least $6 billion because of the new law.

Firms in these sectors may see their long-term tax rates rise, too. But they will gain flexibility: Many high-technology companies have twisted themselves into fiscal knots to avoid paying taxes on overseas cash, including loading up on debt at home and putting off domestic investments.

Some companies are sharing the bounty with employees. AT&T Inc., Comcast Corp. and Bank of America Corp. are granting one-time bonuses of $1,000.

Booking those expenses before year-end would let the companies deduct the costs under their old, higher rates, saving millions.

In a similar move, Goldman will deliver some stock compensation owed to top executives a few weeks early in order to generate tax savings for the firm, according to a person familiar with the matter.

The bank expects to save $140 million by delivering stock to about 300 employees in high-tax states like New York and California, the person said.

Ordinarily those shares, which were earned in prior years, would be delivered next month.

Shareholders are likely to benefit, too.

By removing incentives to park cash overseas, the new tax law frees up billions of dollars that could go toward buybacks and dividends for investors.

One study found that in 2004, when American companies got a chance to bring foreign cash home at lower tax rates, 94 cents of every repatriated dollar was returned to shareholders.

"It's a major windfall of cash," said Alethia Young, a Credit Suisse Group AG biotech analyst.

Meanwhile, Goldman will also write down the value of deferred tax assets, which are past losses and other items that can be used to defray future tax bills. Goldman has about $5 billion of these credits, which are less valuable going forward because the corporate tax rate will be lower.

Deferred-tax assets aren't unique to banks, but Wall Street firms racked up huge losses during the financial crisis and so tend to have a lot of them.

Citigroup Inc. has said it would take a $20 billion earnings charge from writing down its $46 billion of deferred-tax assets as well as for taxes assessed on its overseas profits.

Bank of America expects to take a $3 billion hit on its $19 billion stash, while Credit Suisse and Barclays PLC have announced smaller charges in recent days.

In the long run, though, Wall Street firms will be among the biggest beneficiaries of the new tax system. The law, signed last week by President Donald Trump, reduces the headline corporate tax rate from 35% to 21%, its lowest level since 1939.

Banks are relatively high taxpayers because they get fewer of the breaks, such as for research and development, that are available to technology or pharmaceutical companies. So they benefit more from the rate reduction.

Goldman has averaged a 30% tax rate over the past three years, and JMP's Mr. Ryan estimates an earnings benefit of 5% to 10% a year going forward. Morgan Stanley Chief Executive James Gorman said in June that a 25% corporate tax rate -- higher than it ultimately landed -- would lift his bank's earnings by 15% a year.

---

Joseph Walker and Douglas MacMillan contributed to this article.

